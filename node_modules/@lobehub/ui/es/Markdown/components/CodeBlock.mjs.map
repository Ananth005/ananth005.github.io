{"version":3,"file":"CodeBlock.mjs","names":["Pre"],"sources":["../../../src/Markdown/components/CodeBlock.tsx"],"sourcesContent":["import { memo } from 'react';\n\nimport { type HighlighterProps } from '@/Highlighter';\nimport { FALLBACK_LANG } from '@/Highlighter/const';\nimport { type MermaidProps } from '@/Mermaid';\nimport Pre, { PreMermaid, PreSingleLine } from '@/mdx/mdxComponents/Pre';\n\nconst countLines = (str: string): number => {\n  const regex = /\\n/g;\n  const matches = str.match(regex);\n  return matches ? matches.length : 1;\n};\n\nexport const useCode = (raw: any) => {\n  if (!raw) return;\n\n  const { children, className } = raw.props;\n\n  if (!children) return;\n\n  const content = Array.isArray(children) ? (children[0] as string) : children;\n\n  const lang = className?.replace('language-', '') || FALLBACK_LANG;\n\n  const isSingleLine = countLines(content) <= 1 && content.length <= 32;\n\n  return {\n    content,\n    isSingleLine,\n    lang,\n  };\n};\n\ninterface CodeBlockProps {\n  animated?: boolean;\n  children: any;\n  enableMermaid?: boolean;\n  fullFeatured?: boolean;\n  highlight?: HighlighterProps;\n  mermaid?: MermaidProps;\n}\n\nexport const CodeBlock = memo<CodeBlockProps>(\n  ({ fullFeatured, enableMermaid, highlight, mermaid, children, animated, ...rest }) => {\n    const code = useCode(children);\n\n    if (!code) return;\n\n    if (enableMermaid && code.lang === 'mermaid')\n      return (\n        <PreMermaid fullFeatured={fullFeatured} {...mermaid} {...rest}>\n          {code.content}\n        </PreMermaid>\n      );\n\n    if (!highlight && code.isSingleLine)\n      return <PreSingleLine language={code.lang}>{code.content}</PreSingleLine>;\n\n    return (\n      <Pre\n        animated={animated}\n        fullFeatured={fullFeatured}\n        language={code.lang}\n        {...highlight}\n        {...rest}\n      >\n        {code.content}\n      </Pre>\n    );\n  },\n  (prevProps, nextProps) => prevProps.children === nextProps.children,\n);\n"],"mappings":";;;;;;AAOA,MAAM,cAAc,QAAwB;CAE1C,MAAM,UAAU,IAAI,MADN,MACkB;AAChC,QAAO,UAAU,QAAQ,SAAS;;AAGpC,MAAa,WAAW,QAAa;AACnC,KAAI,CAAC,IAAK;CAEV,MAAM,EAAE,UAAU,cAAc,IAAI;AAEpC,KAAI,CAAC,SAAU;CAEf,MAAM,UAAU,MAAM,QAAQ,SAAS,GAAI,SAAS,KAAgB;CAEpE,MAAM,OAAO,WAAW,QAAQ,aAAa,GAAG,IAAI;AAIpD,QAAO;EACL;EACA,cAJmB,WAAW,QAAQ,IAAI,KAAK,QAAQ,UAAU;EAKjE;EACD;;AAYH,MAAa,YAAY,MACtB,EAAE,cAAc,eAAe,WAAW,SAAS,UAAU,UAAU,GAAG,WAAW;CACpF,MAAM,OAAO,QAAQ,SAAS;AAE9B,KAAI,CAAC,KAAM;AAEX,KAAI,iBAAiB,KAAK,SAAS,UACjC,QACE,oBAAC;EAAyB;EAAc,GAAI;EAAS,GAAI;YACtD,KAAK;GACK;AAGjB,KAAI,CAAC,aAAa,KAAK,aACrB,QAAO,oBAAC;EAAc,UAAU,KAAK;YAAO,KAAK;GAAwB;AAE3E,QACE,oBAACA;EACW;EACI;EACd,UAAU,KAAK;EACf,GAAI;EACJ,GAAI;YAEH,KAAK;GACF;IAGT,WAAW,cAAc,UAAU,aAAa,UAAU,SAC5D"}