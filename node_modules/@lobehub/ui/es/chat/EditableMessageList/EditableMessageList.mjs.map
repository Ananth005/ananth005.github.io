{"version":3,"file":"EditableMessageList.mjs","names":["Flexbox","Select","ControlInput","ActionIcon","Button"],"sources":["../../../src/chat/EditableMessageList/EditableMessageList.tsx"],"sourcesContent":["'use client';\n\nimport isEqual from 'fast-deep-equal';\nimport { Plus, Trash } from 'lucide-react';\nimport { memo, useEffect, useReducer } from 'react';\n\nimport ActionIcon from '@/ActionIcon';\nimport Button from '@/Button';\nimport ControlInput from '@/EditableText/ControlInput';\nimport { Flexbox } from '@/Flex';\nimport Select from '@/Select';\n\nimport { messagesReducer } from './messageReducer';\nimport type { EditableMessageListProps } from './type';\n\nconst EditableMessageList = memo<EditableMessageListProps>(\n  ({ disabled, dataSources, onChange }) => {\n    const [chatMessages, dispatch] = useReducer(messagesReducer, dataSources);\n\n    useEffect(() => {\n      if (!isEqual(dataSources, chatMessages)) {\n        onChange?.(chatMessages);\n      }\n    }, [chatMessages]);\n\n    return dataSources ? (\n      <Flexbox gap={12}>\n        {chatMessages.map((item, index) => (\n          <Flexbox\n            align={'center'}\n            gap={8}\n            horizontal\n            key={`${index}-${item.content}`}\n            width={'100%'}\n          >\n            <Select\n              disabled={disabled}\n              onChange={(value) => {\n                dispatch({ index, role: value, type: 'updateMessageRole' });\n              }}\n              options={[\n                { label: 'System', value: 'system' },\n                { label: 'Input', value: 'user' },\n                { label: 'Output', value: 'assistant' },\n              ]}\n              style={{ width: 120 }}\n              styles={{ popup: { root: { zIndex: 100 } } }}\n              value={item.role}\n            />\n            <ControlInput\n              disabled={disabled}\n              onChange={(e) => {\n                dispatch({ index, message: e, type: 'updateMessage' });\n              }}\n              placeholder={item.role === 'user' ? '请填入输入的样例内容' : '请填入输出的样例'}\n              value={item.content}\n            />\n            <ActionIcon\n              icon={Trash}\n              onClick={() => {\n                dispatch({ index, type: 'deleteMessage' });\n              }}\n              title=\"Delete\"\n              variant={'filled'}\n            />\n          </Flexbox>\n        ))}\n\n        <Button\n          block\n          disabled={disabled}\n          icon={Plus}\n          onClick={() => {\n            const lastMeg = chatMessages.at(-1);\n\n            dispatch({\n              message: { content: '', role: lastMeg?.role === 'user' ? 'assistant' : 'user' },\n              type: 'addMessage',\n            });\n          }}\n        >\n          Add Props\n        </Button>\n      </Flexbox>\n    ) : undefined;\n  },\n  isEqual,\n);\n\nEditableMessageList.displayName = 'EditableMessageList';\n\nexport default EditableMessageList;\n"],"mappings":";;;;;;;;;;;;;;AAeA,MAAM,sBAAsB,MACzB,EAAE,UAAU,aAAa,eAAe;CACvC,MAAM,CAAC,cAAc,YAAY,WAAW,iBAAiB,YAAY;AAEzE,iBAAgB;AACd,MAAI,CAAC,QAAQ,aAAa,aAAa,CACrC,YAAW,aAAa;IAEzB,CAAC,aAAa,CAAC;AAElB,QAAO,cACL,qBAACA;EAAQ,KAAK;aACX,aAAa,KAAK,MAAM,UACvB,qBAACA;GACC,OAAO;GACP,KAAK;GACL;GAEA,OAAO;;IAEP,oBAACC;KACW;KACV,WAAW,UAAU;AACnB,eAAS;OAAE;OAAO,MAAM;OAAO,MAAM;OAAqB,CAAC;;KAE7D,SAAS;MACP;OAAE,OAAO;OAAU,OAAO;OAAU;MACpC;OAAE,OAAO;OAAS,OAAO;OAAQ;MACjC;OAAE,OAAO;OAAU,OAAO;OAAa;MACxC;KACD,OAAO,EAAE,OAAO,KAAK;KACrB,QAAQ,EAAE,OAAO,EAAE,MAAM,EAAE,QAAQ,KAAK,EAAE,EAAE;KAC5C,OAAO,KAAK;MACZ;IACF,oBAACC;KACW;KACV,WAAW,MAAM;AACf,eAAS;OAAE;OAAO,SAAS;OAAG,MAAM;OAAiB,CAAC;;KAExD,aAAa,KAAK,SAAS,SAAS,eAAe;KACnD,OAAO,KAAK;MACZ;IACF,oBAACC;KACC,MAAM;KACN,eAAe;AACb,eAAS;OAAE;OAAO,MAAM;OAAiB,CAAC;;KAE5C,OAAM;KACN,SAAS;MACT;;KAhCG,GAAG,MAAM,GAAG,KAAK,UAiCd,CACV,EAEF,oBAACC;GACC;GACU;GACV,MAAM;GACN,eAAe;AAGb,aAAS;KACP,SAAS;MAAE,SAAS;MAAI,MAHV,aAAa,GAAG,GAAG,EAGM,SAAS,SAAS,cAAc;MAAQ;KAC/E,MAAM;KACP,CAAC;;aAEL;IAEQ;GACD,GACR;GAEN,QACD;AAED,oBAAoB,cAAc;AAElC,kCAAe"}